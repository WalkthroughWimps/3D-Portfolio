<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome • Site Setup</title>
    <link rel="stylesheet" href="template.css">
    <link rel="stylesheet" href="start-page.css">
    <script src="/js/site-utils.js" defer></script>
    <script src="a11y.js" defer></script>
</head>
<body>
    <a href="#main" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">Skip to content</a>
    <button id="settingsBtn" class="settings-overlay-btn" aria-haspopup="dialog" aria-controls="settingsModal">⚙</button>
    <main id="main" class="wrap" aria-labelledby="title">
        <header>
            <h1 id="title">Welcome</h1>
            <p class="lead" id="leadText">Let’s tune a few preferences so the site works best for you.</p>
        </header>

        <div class="top-tabs">
            <div id="topTabA11y" class="tab active">Accessibility</div>
            <div id="topTabAudio" class="tab">Volume / Sync</div>
        </div>
        <section id="a11ySection" aria-labelledby="a11y-title">
            <h2 id="a11y-title" class="section-title">Accessibility</h2>
            <div class="row" role="group" aria-labelledby="a11y-title">
                <div class="control">
                    <div>
                        <label for="a11y_reduced_motion">Reduced motion</label>
                        <div class="hint">Minimize animations and transitions.</div>
                    </div>
                    <input id="a11y_reduced_motion" type="checkbox" aria-describedby="a11y_reduced_motion_hint">
                </div>

                <div class="control">
                    <div>
                        <label for="a11y_high_contrast">High contrast</label>
                        <div class="hint">Increase contrast for readability.</div>
                    </div>
                    <input id="a11y_high_contrast" type="checkbox">
                </div>

                <div class="control">
                    <div>
                        <span id="a11y_text_size_label" style="font-weight:600;">Text size</span>
                        <div class="hint">Choose a comfortable reading size.</div>
                    </div>
                    <div class="radios" role="radiogroup" aria-labelledby="a11y_text_size_label">
                        <label><input type="radio" name="a11y_text" value="normal"> Normal</label>
                        <label><input type="radio" name="a11y_text" value="large"> Large</label>
                    </div>
                </div>

                <div class="control">
                    <div>
                        <label for="a11y_focus_outlines">Always show focus outlines</label>
                        <div class="hint">Keep keyboard focus rings visible.</div>
                    </div>
                    <input id="a11y_focus_outlines" type="checkbox">
                </div>
            </div>
            <div class="actions">
                <button id="save_a11y" class="primary">Save accessibility</button>
                <button id="reset_a11y" class="secondary" type="button">Reset to defaults</button>
            </div>
        </section>
        <!-- Jump player container -->
        <div id="jumpContainer" class="jump-container" aria-hidden="true" tabindex="0">
        <div class="jump-body">
            <div class="visualizer-container">
                <div class="viz-meter">
                        <div class="viz-scale" aria-hidden="true">
                            <div class="viz-mark"><span>0</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-3</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-6</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-9</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-12</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-15</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-18</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-21</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-24</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-27</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-30</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-33</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-36</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-39</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-42</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-45</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-48</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-51</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-54</span><span class="viz-rule"></span></div>
                            <div class="viz-mark"><span>-ꝏ</span><span class="viz-rule"></span></div>
                        </div>
                        <canvas id="visualizer" width="28" height="420"></canvas>
                    </div>
                    <div id="vizDb" class="viz-readout">dB: -inf</div>
                </div>

                <div class="media-layout">
                    <div class="video-area">
                <div class="video-wrapper" id="videoWrapper">
                    <video id="jumpVideo" preload="metadata" controls crossorigin="anonymous" tabindex="0">
                        <!-- sources set dynamically -->
                    </video>
                    <!-- Hidden separate audio element used as the WebAudio source for syncing -->
                    <audio id="jumpAudio" preload="auto" crossorigin="anonymous" style="display:none"></audio>
                </div>
                <div class="tab-info" id="tabInfo">Adjust accessibility settings</div>

                <!-- Video selection tabs below the video and above sync slider -->
                    <div class="video-tabs">
                        <div id="tab-numbers" class="tab active" role="tab" aria-selected="true">Numbers 1-2-3</div>
                        <div id="tab-alphabet" class="tab" role="tab" aria-selected="false">Alphabet A-B-C</div>
                    </div>

                    <div class="controls-row">
                        <div class="hint">Playback controls</div>
                        <div class="hint" id="syncDisplay">Sync: 0 ms</div>
                    </div>

                    <div class="sync-controls">
                        <div class="sync-row">
                            <button class="arrow-btn" id="syncLeft">&lt;</button>
                            <input id="syncSlider" class="sync-slider" type="range" min="-3000" max="3000" step="10" value="0" aria-label="A/V sync (ms)">
                            <button class="arrow-btn" id="syncRight">&gt;</button>
                        </div>
                        <div id="settingsPanel" class="settings-panel">
                            <div id="settingsA11ySummary" class="hidden">Accessibility saved. Use the main controls to edit.</div>
                        </div>
                        <div class="mouse-legend" aria-hidden="true">
                            <img class="mouse-icon" src="assets/SVG/mouse-LMB.svg" alt="Left mouse button">
                            <img class="mouse-icon" src="assets/SVG/mouse_RMB.svg" alt="Right mouse button">
                        </div>
                        <div class="jump-actions">
                            <button id="nextBtn" class="primary" type="button">Next</button>
                        </div>
                    </div>
                </div>
                <div class="volume-column">
                    <div class="volume-label">Volume</div>
                    <div class="volume-slider-wrapper" role="group" aria-label="Master volume">
                        <button class="arrow-btn vertical" id="volUp">&#9650;</button>
                        <input id="volumeSlider" class="volume-slider-vertical" type="range" min="0" max="100" step="1" value="25" aria-label="Volume (%)">
                        <button class="arrow-btn vertical" id="volDown">&#9660;</button>
                    </div>
                    <div class="volume-display">Volume: <span id="volumeDisplay">25%</span></div>
                </div>
            </div>
        </div>
        </div>

    </main>

    <!-- Temporary muted-attribution test harness; remove once verification is complete -->
    <section id="attr-test-harness" aria-live="polite" style="margin:24px;gap:12px;display:flex;flex-direction:column;">
        <p style="margin:0;font-weight:600;">Muted attribution formatting tests (remove after checking):</p>
        <div id="attr-test-1"></div>
        <div id="attr-test-2"></div>
        <div id="attr-test-3"></div>
        <div id="attr-test-4"></div>
        <div id="attr-test-5"></div>
        <div id="attr-test-6"></div>
    </section>

    <!-- Temporary full attribution rendering checks -->
    <section id="full-attr-test-harness" aria-live="polite" style="margin:24px;gap:12px;display:flex;flex-direction:column;">
        <p style="margin:0;font-weight:600;">Full attribution rendering tests (remove after verification):</p>
        <div id="full-attr-test-1"></div>
        <div id="full-attr-test-2"></div>
        <div id="full-attr-test-3"></div>
    </section>

    <!-- Permission modal -->
    <div id="permissionModal" class="permission-modal hidden" role="dialog" aria-modal="true" aria-labelledby="permTitle">
        <div class="permission-box">
            <h3 id="permTitle">Allow sound?</h3>
            <p>This site would like to play sound for the sample videos. Allow audio playback?</p>
            <div style="display:flex;gap:8px;margin-top:12px;">
                <button id="permAllow" class="primary">Allow</button>
                <button id="permDeny" class="secondary">Deny</button>
            </div>
        </div>
    </div>

    <!-- Settings modal (triggered by nav/settings button) -->
    <div id="settingsModal" class="settings-modal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
        <div class="settings-box">
            <h3 id="settingsTitle">Settings</h3>
            <div style="display:flex;gap:8px;margin-top:8px;">
                <div id="modalTabA11y" class="settings-tab">Accessibility</div>
                <div id="modalTabAudio" class="settings-tab active">Volume / Sync</div>
            </div>
            <div style="margin-top:12px;">
                <div id="modalA11yContent" class="hidden">
                    <!-- Reuse minimal controls for editing -->
                    <div class="control"><label>Reduced motion</label><input id="modal_a11y_reduced_motion" type="checkbox"></div>
                    <div class="control"><label>High contrast</label><input id="modal_a11y_high_contrast" type="checkbox"></div>
                    <div style="margin-top:8px;display:flex;gap:8px;"><button id="modalSaveA11y" class="primary">Save</button><button id="modalClose" class="secondary">Close</button></div>
                </div>
                <div id="modalAudioContent">
                    <div style="display:flex;gap:12px;align-items:center;">
                        <div>Sync</div>
                        <input id="modalSync" type="range" min="-3000" max="3000" step="50" value="0">
                    </div>
                    <div style="margin-top:8px;display:flex;gap:8px;">
                        <button id="modalClose2" class="secondary">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="start-page.js" defer></script>
</body>
</html>
